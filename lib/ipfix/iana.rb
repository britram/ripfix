#
#--
# ripfix (IPFIX for Ruby) (c) 2010 Brian Trammell and Hitachi Europe SAS
# Special thanks to the PRISM Consortium (fp7-prism.eu) for its support.
# Distributed under the terms of the GNU Lesser General Public License v3.
#++
# Extends the InfoModel class for convenient handling of IANA Information
# Elements.
#

require_relative 'model'
require 'uri'
require 'net/http'
require 'rexml/document'

module IPFIX
  
  class InfoModel
    
#
# Loads the Information Elements from an ipfix.xml file at a specified URI;
# defaults to the IANA IPFIX Assignments at 
# http://www.iana.org/assignments/ipfix/ipfix.xml
#
    def load_xml(uri = "http://www.iana.org/assignments/ipfix/ipfix.xml")
      
      res = Net::HTTP.get_response(URI.parse(uri))
      if (res.code.to_i != 200)
        raise "Unable to retrieve IANA registry from #{uri}: #{res.code}"
      end
      
      doc = REXML::Document.new res.body
      
      doc.elements.each("*/registry[@id='ipfix-information-element-definitions']/record") do |rec|
      
        name = rec.elements["name"]
        number = rec.elements["elementId"]
        typename = rec.elements["dataType"]
    
        if (name && number && typename)
          name = name.text
          number = number.text.to_i
          type = type_for_name(typename.text)
          
          if (!type)
            type = type_for_name("octetArray")
            puts "warning: setting type of #{name} to octetArray: unknown type #{typename.text}"
          end

          add(InfoElement.new(name, 0, number, type))

        end
      end
      
      self
    end

#
# Loads the Information Elements from an internal default specifier list,
# containing the IANA IPFIX Assignments at 
# http://www.iana.org/assignments/ipfix/ipfix.xml with IE numbers below 128 
# (i.e., the NetFlow V9 compatible IE space) as of the release date
# of this revision of ripfix.
#


def load_v9_compatible
  
      %w( octetDeltaCount(1)<unsigned64>[8]
          packetDeltaCount(2)<unsigned64>[8]
          protocolIdentifier(4)<unsigned8>[1]
          ipClassOfService(5)<unsigned8>[1]
          tcpControlBits(6)<unsigned8>[1]
          sourceTransportPort(7)<unsigned16>[2]
          sourceIPv4Address(8)<ipv4Address>[4]
          sourceIPv4PrefixLength(9)<unsigned8>[1]
          ingressInterface(10)<unsigned32>[4]
          destinationTransportPort(11)<unsigned16>[2]
          destinationIPv4Address(12)<ipv4Address>[4]
          destinationIPv4PrefixLength(13)<unsigned8>[1]
          egressInterface(14)<unsigned32>[4]
          ipNextHopIPv4Address(15)<ipv4Address>[4]
          bgpSourceAsNumber(16)<unsigned32>[4]
          bgpDestinationAsNumber(17)<unsigned32>[4]
          bgpNextHopIPv4Address(18)<ipv4Address>[4]
          postMCastPacketDeltaCount(19)<unsigned64>[8]
          postMCastOctetDeltaCount(20)<unsigned64>[8]
          flowEndSysUpTime(21)<unsigned32>[4]
          flowStartSysUpTime(22)<unsigned32>[4]
          postOctetDeltaCount(23)<unsigned64>[8]
          postPacketDeltaCount(24)<unsigned64>[8]
          minimumIpTotalLength(25)<unsigned64>[8]
          maximumIpTotalLength(26)<unsigned64>[8]
          sourceIPv6Address(27)<ipv6Address>[16]
          destinationIPv6Address(28)<ipv6Address>[16]
          sourceIPv6PrefixLength(29)<unsigned8>[1]
          destinationIPv6PrefixLength(30)<unsigned8>[1]
          flowLabelIPv6(31)<unsigned32>[4]
          icmpTypeCodeIPv4(32)<unsigned16>[2]
          igmpType(33)<unsigned8>[1]
          flowActiveTimeout(36)<unsigned16>[2]
          flowIdleTimeout(37)<unsigned16>[2]
          exportedOctetTotalCount(40)<unsigned64>[8]
          exportedMessageTotalCount(41)<unsigned64>[8]
          exportedFlowRecordTotalCount(42)<unsigned64>[8]
          sourceIPv4Prefix(44)<ipv4Address>[4]
          destinationIPv4Prefix(45)<ipv4Address>[4]
          mplsTopLabelType(46)<unsigned8>[1]
          mplsTopLabelIPv4Address(47)<ipv4Address>[4]
          minimumTTL(52)<unsigned8>[1]
          maximumTTL(53)<unsigned8>[1]
          fragmentIdentification(54)<unsigned32>[4]
          postIpClassOfService(55)<unsigned8>[1]
          sourceMacAddress(56)<macAddress>[6]
          postDestinationMacAddress(57)<macAddress>[6]
          vlanId(58)<unsigned16>[2]
          postVlanId(59)<unsigned16>[2]
          ipVersion(60)<unsigned8>[1]
          flowDirection(61)<unsigned8>[1]
          ipNextHopIPv6Address(62)<ipv6Address>[16]
          bgpNextHopIPv6Address(63)<ipv6Address>[16]
          ipv6ExtensionHeaders(64)<unsigned32>[4]
          mplsTopLabelStackSection(70)<octetArray>[3]
          mplsLabelStackSection2(71)<octetArray>[3]
          mplsLabelStackSection3(72)<octetArray>[3]
          mplsLabelStackSection4(73)<octetArray>[3]
          mplsLabelStackSection5(74)<octetArray>[3]
          mplsLabelStackSection6(75)<octetArray>[3]
          mplsLabelStackSection7(76)<octetArray>[3]
          mplsLabelStackSection8(77)<octetArray>[3]
          mplsLabelStackSection9(78)<octetArray>[3]
          mplsLabelStackSection10(79)<octetArray>[3]
          destinationMacAddress(80)<macAddress>[6]
          postSourceMacAddress(81)<macAddress>[6]
          interfaceName(82)<string>[65535]
          interfaceDescription(83)<string>[65535]
          octetTotalCount(85)<unsigned64>[8]
          packetTotalCount(86)<unsigned64>[8]
          fragmentOffset(88)<unsigned16>[2]
          mplsVpnRouteDistinguisher(90)<octetArray>[8]
          mplsTopLabelPrefixLength(91)<unsigned8>[1]
          postIpDiffServCodePoint(98)<unsigned8>[1]).each { |spec| add_spec(spec) }
      self
    end


#
# Loads the Information Elements from an internal default specifier list,
# containing the IANA IPFIX Assignments at 
# http://www.iana.org/assignments/ipfix/ipfix.xml as of the release date
# of this revision of ripfix. Loads NetFlow V9 compatible IEs as well.
#
    def load_default()
      
      # first, do IEs to 128
      load_v9_compatible
      
      # now the rest of the IANA IEs
      %w( bgpNextAdjacentAsNumber(128)<unsigned32>[4]
          bgpPrevAdjacentAsNumber(129)<unsigned32>[4]
          exporterIPv4Address(130)<ipv4Address>[4]
          exporterIPv6Address(131)<ipv6Address>[16]
          droppedOctetDeltaCount(132)<unsigned64>[8]
          droppedPacketDeltaCount(133)<unsigned64>[8]
          droppedOctetTotalCount(134)<unsigned64>[8]
          droppedPacketTotalCount(135)<unsigned64>[8]
          flowEndReason(136)<unsigned8>[1]
          commonPropertiesId(137)<unsigned64>[8]
          observationPointId(138)<unsigned32>[4]
          icmpTypeCodeIPv6(139)<unsigned16>[2]
          mplsTopLabelIPv6Address(140)<ipv6Address>[16]
          lineCardId(141)<unsigned32>[4]
          portId(142)<unsigned32>[4]
          meteringProcessId(143)<unsigned32>[4]
          exportingProcessId(144)<unsigned32>[4]
          templateId(145)<unsigned16>[2]
          wlanChannelId(146)<unsigned8>[1]
          wlanSSID(147)<string>[32]
          flowId(148)<unsigned64>[8]
          observationDomainId(149)<unsigned32>[4]
          flowStartSeconds(150)<dateTimeSeconds>[4]
          flowEndSeconds(151)<dateTimeSeconds>[4]
          flowStartMilliseconds(152)<dateTimeMilliseconds>[8]
          flowEndMilliseconds(153)<dateTimeMilliseconds>[8]
          flowStartMicroseconds(154)<dateTimeMicroseconds>[8]
          flowEndMicroseconds(155)<dateTimeMicroseconds>[8]
          flowStartNanoseconds(156)<dateTimeNanoseconds>[8]
          flowEndNanoseconds(157)<dateTimeNanoseconds>[8]
          flowStartDeltaMicroseconds(158)<unsigned32>[4]
          flowEndDeltaMicroseconds(159)<unsigned32>[4]
          systemInitTimeMilliseconds(160)<dateTimeMilliseconds>[8]
          flowDurationMilliseconds(161)<unsigned32>[4]
          flowDurationMicroseconds(162)<unsigned32>[4]
          observedFlowTotalCount(163)<unsigned64>[8]
          ignoredPacketTotalCount(164)<unsigned64>[8]
          ignoredOctetTotalCount(165)<unsigned64>[8]
          notSentFlowTotalCount(166)<unsigned64>[8]
          notSentPacketTotalCount(167)<unsigned64>[8]
          notSentOctetTotalCount(168)<unsigned64>[8]
          destinationIPv6Prefix(169)<ipv6Address>[16]
          sourceIPv6Prefix(170)<ipv6Address>[16]
          postOctetTotalCount(171)<unsigned64>[8]
          postPacketTotalCount(172)<unsigned64>[8]
          flowKeyIndicator(173)<unsigned64>[8]
          postMCastPacketTotalCount(174)<unsigned64>[8]
          postMCastOctetTotalCount(175)<unsigned64>[8]
          icmpTypeIPv4(176)<unsigned8>[1]
          icmpCodeIPv4(177)<unsigned8>[1]
          icmpTypeIPv6(178)<unsigned8>[1]
          icmpCodeIPv6(179)<unsigned8>[1]
          udpSourcePort(180)<unsigned16>[2]
          udpDestinationPort(181)<unsigned16>[2]
          tcpSourcePort(182)<unsigned16>[2]
          tcpDestinationPort(183)<unsigned16>[2]
          tcpSequenceNumber(184)<unsigned32>[4]
          tcpAcknowledgementNumber(185)<unsigned32>[4]
          tcpWindowSize(186)<unsigned16>[2]
          tcpUrgentPointer(187)<unsigned16>[2]
          tcpHeaderLength(188)<unsigned8>[1]
          ipHeaderLength(189)<unsigned8>[1]
          totalLengthIPv4(190)<unsigned16>[2]
          payloadLengthIPv6(191)<unsigned16>[2]
          ipTTL(192)<unsigned8>[1]
          nextHeaderIPv6(193)<unsigned8>[1]
          mplsPayloadLength(194)<unsigned32>[4]
          ipDiffServCodePoint(195)<unsigned8>[1]
          ipPrecedence(196)<unsigned8>[1]
          fragmentFlags(197)<unsigned8>[1]
          octetDeltaSumOfSquares(198)<unsigned64>[8]
          octetTotalSumOfSquares(199)<unsigned64>[8]
          mplsTopLabelTTL(200)<unsigned8>[1]
          mplsLabelStackLength(201)<unsigned32>[4]
          mplsLabelStackDepth(202)<unsigned32>[4]
          mplsTopLabelExp(203)<unsigned8>[1]
          ipPayloadLength(204)<unsigned32>[4]
          udpMessageLength(205)<unsigned16>[2]
          isMulticast(206)<unsigned8>[1]
          ipv4IHL(207)<unsigned8>[1]
          ipv4Options(208)<unsigned32>[4]
          tcpOptions(209)<unsigned64>[8]
          paddingOctets(210)<octetArray>[1]
          collectorIPv4Address(211)<ipv4Address>[4]
          collectorIPv6Address(212)<ipv6Address>[16]
          exportInterface(213)<unsigned32>[4]
          exportProtocolVersion(214)<unsigned8>[1]
          exportTransportProtocol(215)<unsigned8>[1]
          collectorTransportPort(216)<unsigned16>[2]
          exporterTransportPort(217)<unsigned16>[2]
          tcpSynTotalCount(218)<unsigned64>[8]
          tcpFinTotalCount(219)<unsigned64>[8]
          tcpRstTotalCount(220)<unsigned64>[8]
          tcpPshTotalCount(221)<unsigned64>[8]
          tcpAckTotalCount(222)<unsigned64>[8]
          tcpUrgTotalCount(223)<unsigned64>[8]
          ipTotalLength(224)<unsigned64>[8]
          postNATSourceIPv4Address(225)<ipv4Address>[4]
          postNATDestinationIPv4Address(226)<ipv4Address>[4]
          postNAPTSourceTransportPort(227)<unsigned16>[2]
          postNAPTDestinationTransportPort(228)<unsigned16>[2]
          natOriginatingAddressRealm(229)<unsigned8>[1]
          natEvent(230)<unsigned8>[1]
          initiatorOctets(231)<unsigned64>[8]
          responderOctets(232)<unsigned64>[8]
          firewallEvent(233)<unsigned8>[1]
          ingressVRFID(234)<unsigned32>[4]
          egressVRFID(235)<unsigned32>[4]
          VRFname(236)<string>[65535]
          postMplsTopLabelExp(237)<unsigned8>[1]
          tcpWindowScale(238)<unsigned16>[2]
          biflowDirection(239)<unsigned8>[1]
          ethernetHeaderLength(240)<unsigned8>[1]
          ethernetPayloadLength(241)<unsigned16>[2]
          ethernetTotalLength(242)<unsigned16>[2]
          dot1qVlanId(243)<unsigned16>[2]
          dot1qPriority(244)<unsigned8>[1]
          dot1qCustomerVlanId(245)<unsigned16>[2]
          dot1qCustomerPriority(246)<unsigned8>[1]
          metroEvcId(247)<string>[100]
          metroEvcType(248)<unsigned8>[1]
          pseudoWireId(249)<unsigned32>[4]
          pseudoWireType(250)<unsigned16>[2]
          pseudoWireControlWord(251)<unsigned32>[4]
          ingressPhysicalInterface(252)<unsigned32>[4]
          egressPhysicalInterface(253)<unsigned32>[4]
          postDot1qVlanId(254)<unsigned16>[2]
          postDot1qCustomerVlanId(255)<unsigned16>[2]
          ethernetType(256)<unsigned16>[2]
          postIpPrecedence(257)<unsigned8>[1]
          selectionSequenceId(301)<unsigned64>[8]
          selectorId(302)<unsigned16>[2]
          informationElementId(303)<unsigned16>[2]
          selectorAlgorithm(304)<unsigned16>[2]
          samplingPacketInterval(305)<unsigned32>[4]
          samplingPacketSpace(306)<unsigned32>[4]
          samplingTimeInterval(307)<unsigned32>[4]
          samplingTimeSpace(308)<unsigned32>[4]
          samplingSize(309)<unsigned32>[4]
          samplingPopulation(310)<unsigned32>[4]
          samplingProbability(311)<float64>[8]
          ipHeaderPacketSection(313)<octetArray>[65535]
          ipPayloadPacketSection(314)<octetArray>[65535]
          mplsLabelStackSection(316)<octetArray>[65535]
          mplsPayloadPacketSection(317)<octetArray>[65535]
          selectorIdTotalPktsObserved(318)<unsigned64>[8]
          selectorIdTotalPktsSelected(319)<unsigned64>[8]
          absoluteError(320)<float64>[8]
          relativeError(321)<float64>[8]
          observationTimeSeconds(322)<dateTimeSeconds>[4]
          observationTimeMilliseconds(323)<dateTimeMilliseconds>[8]
          observationTimeMicroseconds(324)<dateTimeMicroseconds>[8]
          observationTimeNanoseconds(325)<dateTimeNanoseconds>[8]
          digestHashValue(326)<unsigned64>[8]
          hashIPPayloadOffset(327)<unsigned64>[8]
          hashIPPayloadSize(328)<unsigned64>[8]
          hashOutputRangeMin(329)<unsigned64>[8]
          hashOutputRangeMax(330)<unsigned64>[8]
          hashSelectedRangeMin(331)<unsigned64>[8]
          hashSelectedRangeMax(332)<unsigned64>[8]
          hashDigestOutput(333)<boolean>[1]
          hashInitialiserValue(334)<unsigned64>[8]
          selectorName(335)<string>[65535]
          upperCILimit(336)<float64>[8]
          lowerCILimit(337)<float64>[8]
          confidenceLevel(338)<float64>[8]
          informationElementDataType(339)<unsigned8>[1]
          informationElementDescription(340)<string>[65535]
          informationElementName(341)<string>[65535]
          informationElementRangeBegin(342)<unsigned64>[8]
          informationElementRangeEnd(343)<unsigned64>[8]
          informationElementSemantics(344)<unsigned8>[1]
          informationElementUnits(345)<unsigned16>[2]
          privateEnterpriseNumber(346)<unsigned32>[4]).each { |spec| add_spec(spec) }
      self
    end

#
# Loads reverse Information Elements from an internal default specifier list,
# containing the reverse of the IANA IPFIX Assignments at 
# http://www.iana.org/assignments/ipfix/ipfix.xml as per RFC 5103 as of the 
# release date of this revision of ripfix.
#    
    def load_reverse()
      %w( reverseOctetDeltaCount(29305/1)<unsigned64>[8]
          reversePacketDeltaCount(29305/2)<unsigned64>[8]
          reverseProtocolIdentifier(29305/4)<unsigned8>[1]
          reverseIpClassOfService(29305/5)<unsigned8>[1]
          reverseTcpControlBits(29305/6)<unsigned8>[1]
          reverseSourceTransportPort(29305/7)<unsigned16>[2]
          reverseSourceIPv4Address(29305/8)<ipv4Address>[4]
          reverseSourceIPv4PrefixLength(29305/9)<unsigned8>[1]
          reverseIngressInterface(29305/10)<unsigned32>[4]
          reverseDestinationTransportPort(29305/11)<unsigned16>[2]
          reverseDestinationIPv4Address(29305/12)<ipv4Address>[4]
          reverseDestinationIPv4PrefixLength(29305/13)<unsigned8>[1]
          reverseEgressInterface(29305/14)<unsigned32>[4]
          reverseIpNextHopIPv4Address(29305/15)<ipv4Address>[4]
          reverseBgpSourceAsNumber(29305/16)<unsigned32>[4]
          reverseBgpDestinationAsNumber(29305/17)<unsigned32>[4]
          reverseBgpNextHopIPv4Address(29305/18)<ipv4Address>[4]
          reversePostMCastPacketDeltaCount(29305/19)<unsigned64>[8]
          reversePostMCastOctetDeltaCount(29305/20)<unsigned64>[8]
          reverseFlowEndSysUpTime(29305/21)<unsigned32>[4]
          reverseFlowStartSysUpTime(29305/22)<unsigned32>[4]
          reversePostOctetDeltaCount(29305/23)<unsigned64>[8]
          reversePostPacketDeltaCount(29305/24)<unsigned64>[8]
          reverseMinimumIpTotalLength(29305/25)<unsigned64>[8]
          reverseMaximumIpTotalLength(29305/26)<unsigned64>[8]
          reverseSourceIPv6Address(29305/27)<ipv6Address>[16]
          reverseDestinationIPv6Address(29305/28)<ipv6Address>[16]
          reverseSourceIPv6PrefixLength(29305/29)<unsigned8>[1]
          reverseDestinationIPv6PrefixLength(29305/30)<unsigned8>[1]
          reverseFlowLabelIPv6(29305/31)<unsigned32>[4]
          reverseIcmpTypeCodeIPv4(29305/32)<unsigned16>[2]
          reverseIgmpType(29305/33)<unsigned8>[1]
          reverseFlowActiveTimeout(29305/36)<unsigned16>[2]
          reverseFlowIdleTimeout(29305/37)<unsigned16>[2]
          reverseSourceIPv4Prefix(29305/44)<ipv4Address>[4]
          reverseDestinationIPv4Prefix(29305/45)<ipv4Address>[4]
          reverseMplsTopLabelType(29305/46)<unsigned8>[1]
          reverseMplsTopLabelIPv4Address(29305/47)<ipv4Address>[4]
          reverseMinimumTTL(29305/52)<unsigned8>[1]
          reverseMaximumTTL(29305/53)<unsigned8>[1]
          reverseFragmentIdentification(29305/54)<unsigned32>[4]
          reversePostIpClassOfService(29305/55)<unsigned8>[1]
          reverseSourceMacAddress(29305/56)<macAddress>[6]
          reversePostDestinationMacAddress(29305/57)<macAddress>[6]
          reverseVlanId(29305/58)<unsigned16>[2]
          reversePostVlanId(29305/59)<unsigned16>[2]
          reverseIpVersion(29305/60)<unsigned8>[1]
          reverseFlowDirection(29305/61)<unsigned8>[1]
          reverseIpNextHopIPv6Address(29305/62)<ipv6Address>[16]
          reverseBgpNextHopIPv6Address(29305/63)<ipv6Address>[16]
          reverseIpv6ExtensionHeaders(29305/64)<unsigned32>[4]
          reverseMplsTopLabelStackSection(29305/70)<octetArray>[3]
          reverseMplsLabelStackSection2(29305/71)<octetArray>[3]
          reverseMplsLabelStackSection3(29305/72)<octetArray>[3]
          reverseMplsLabelStackSection4(29305/73)<octetArray>[3]
          reverseMplsLabelStackSection5(29305/74)<octetArray>[3]
          reverseMplsLabelStackSection6(29305/75)<octetArray>[3]
          reverseMplsLabelStackSection7(29305/76)<octetArray>[3]
          reverseMplsLabelStackSection8(29305/77)<octetArray>[3]
          reverseMplsLabelStackSection9(29305/78)<octetArray>[3]
          reverseMplsLabelStackSection10(29305/79)<octetArray>[3]
          reverseDestinationMacAddress(29305/80)<macAddress>[6]
          reversePostSourceMacAddress(29305/81)<macAddress>[6]
          reverseInterfaceName(29305/82)<string>[65535]
          reverseInterfaceDescription(29305/83)<string>[65535]
          reverseOctetTotalCount(29305/85)<unsigned64>[8]
          reversePacketTotalCount(29305/86)<unsigned64>[8]
          reverseFragmentOffset(29305/88)<unsigned16>[2]
          reverseMplsVpnRouteDistinguisher(29305/90)<octetArray>[8]
          reverseMplsTopLabelPrefixLength(29305/91)<unsigned8>[1]
          reversePostIpDiffServCodePoint(29305/98)<unsigned8>[1]
          reverseBgpNextAdjacentAsNumber(29305/128)<unsigned32>[4]
          reverseBgpPrevAdjacentAsNumber(29305/129)<unsigned32>[4]
          reverseDroppedOctetDeltaCount(29305/132)<unsigned64>[8]
          reverseDroppedPacketDeltaCount(29305/133)<unsigned64>[8]
          reverseDroppedOctetTotalCount(29305/134)<unsigned64>[8]
          reverseDroppedPacketTotalCount(29305/135)<unsigned64>[8]
          reverseFlowEndReason(29305/136)<unsigned8>[1]
          reverseObservationPointId(29305/138)<unsigned32>[4]
          reverseIcmpTypeCodeIPv6(29305/139)<unsigned16>[2]
          reverseMplsTopLabelIPv6Address(29305/140)<ipv6Address>[16]
          reverseLineCardId(29305/141)<unsigned32>[4]
          reversePortId(29305/142)<unsigned32>[4]
          reverseMeteringProcessId(29305/143)<unsigned32>[4]
          reverseExportingProcessId(29305/144)<unsigned32>[4]
          reverseWlanChannelId(29305/146)<unsigned8>[1]
          reverseWlanSSID(29305/147)<string>[32]
          reverseFlowStartSeconds(29305/150)<dateTimeSeconds>[4]
          reverseFlowEndSeconds(29305/151)<dateTimeSeconds>[4]
          reverseFlowStartMilliseconds(29305/152)<dateTimeMilliseconds>[8]
          reverseFlowEndMilliseconds(29305/153)<dateTimeMilliseconds>[8]
          reverseFlowStartMicroseconds(29305/154)<dateTimeMicroseconds>[8]
          reverseFlowEndMicroseconds(29305/155)<dateTimeMicroseconds>[8]
          reverseFlowStartNanoseconds(29305/156)<dateTimeNanoseconds>[8]
          reverseFlowEndNanoseconds(29305/157)<dateTimeNanoseconds>[8]
          reverseFlowStartDeltaMicroseconds(29305/158)<unsigned32>[4]
          reverseFlowEndDeltaMicroseconds(29305/159)<unsigned32>[4]
          reverseSystemInitTimeMilliseconds(29305/160)<dateTimeMilliseconds>[8]
          reverseFlowDurationMilliseconds(29305/161)<unsigned32>[4]
          reverseFlowDurationMicroseconds(29305/162)<unsigned32>[4]
          reverseDestinationIPv6Prefix(29305/169)<ipv6Address>[16]
          reverseSourceIPv6Prefix(29305/170)<ipv6Address>[16]
          reversePostOctetTotalCount(29305/171)<unsigned64>[8]
          reversePostPacketTotalCount(29305/172)<unsigned64>[8]
          reversePostMCastPacketTotalCount(29305/174)<unsigned64>[8]
          reversePostMCastOctetTotalCount(29305/175)<unsigned64>[8]
          reverseIcmpTypeIPv4(29305/176)<unsigned8>[1]
          reverseIcmpCodeIPv4(29305/177)<unsigned8>[1]
          reverseIcmpTypeIPv6(29305/178)<unsigned8>[1]
          reverseIcmpCodeIPv6(29305/179)<unsigned8>[1]
          reverseUdpSourcePort(29305/180)<unsigned16>[2]
          reverseUdpDestinationPort(29305/181)<unsigned16>[2]
          reverseTcpSourcePort(29305/182)<unsigned16>[2]
          reverseTcpDestinationPort(29305/183)<unsigned16>[2]
          reverseTcpSequenceNumber(29305/184)<unsigned32>[4]
          reverseTcpAcknowledgementNumber(29305/185)<unsigned32>[4]
          reverseTcpWindowSize(29305/186)<unsigned16>[2]
          reverseTcpUrgentPointer(29305/187)<unsigned16>[2]
          reverseTcpHeaderLength(29305/188)<unsigned8>[1]
          reverseIpHeaderLength(29305/189)<unsigned8>[1]
          reverseTotalLengthIPv4(29305/190)<unsigned16>[2]
          reversePayloadLengthIPv6(29305/191)<unsigned16>[2]
          reverseIpTTL(29305/192)<unsigned8>[1]
          reverseNextHeaderIPv6(29305/193)<unsigned8>[1]
          reverseMplsPayloadLength(29305/194)<unsigned32>[4]
          reverseIpDiffServCodePoint(29305/195)<unsigned8>[1]
          reverseIpPrecedence(29305/196)<unsigned8>[1]
          reverseFragmentFlags(29305/197)<unsigned8>[1]
          reverseOctetDeltaSumOfSquares(29305/198)<unsigned64>[8]
          reverseOctetTotalSumOfSquares(29305/199)<unsigned64>[8]
          reverseMplsTopLabelTTL(29305/200)<unsigned8>[1]
          reverseMplsLabelStackLength(29305/201)<unsigned32>[4]
          reverseMplsLabelStackDepth(29305/202)<unsigned32>[4]
          reverseMplsTopLabelExp(29305/203)<unsigned8>[1]
          reverseIpPayloadLength(29305/204)<unsigned32>[4]
          reverseUdpMessageLength(29305/205)<unsigned16>[2]
          reverseIsMulticast(29305/206)<unsigned8>[1]
          reverseIpv4IHL(29305/207)<unsigned8>[1]
          reverseIpv4Options(29305/208)<unsigned32>[4]
          reverseTcpOptions(29305/209)<unsigned64>[8]
          reverseTcpSynTotalCount(29305/218)<unsigned64>[8]
          reverseTcpFinTotalCount(29305/219)<unsigned64>[8]
          reverseTcpRstTotalCount(29305/220)<unsigned64>[8]
          reverseTcpPshTotalCount(29305/221)<unsigned64>[8]
          reverseTcpAckTotalCount(29305/222)<unsigned64>[8]
          reverseTcpUrgTotalCount(29305/223)<unsigned64>[8]
          reverseIpTotalLength(29305/224)<unsigned64>[8]
          reversePostNATSourceIPv4Address(29305/225)<ipv4Address>[4]
          reversePostNATDestinationIPv4Address(29305/226)<ipv4Address>[4]
          reversePostNAPTSourceTransportPort(29305/227)<unsigned16>[2]
          reversePostNAPTDestinationTransportPort(29305/228)<unsigned16>[2]
          reverseNatOriginatingAddressRealm(29305/229)<unsigned8>[1]
          reverseNatEvent(29305/230)<unsigned8>[1]
          reverseInitiatorOctets(29305/231)<unsigned64>[8]
          reverseResponderOctets(29305/232)<unsigned64>[8]
          reverseFirewallEvent(29305/233)<unsigned8>[1]
          reverseIngressVRFID(29305/234)<unsigned32>[4]
          reverseEgressVRFID(29305/235)<unsigned32>[4]
          reverseVRFname(29305/236)<string>[65535]
          reversePostMplsTopLabelExp(29305/237)<unsigned8>[1]
          reverseTcpWindowScale(29305/238)<unsigned16>[2]
          reverseEthernetHeaderLength(29305/240)<unsigned8>[1]
          reverseEthernetPayloadLength(29305/241)<unsigned16>[2]
          reverseEthernetTotalLength(29305/242)<unsigned16>[2]
          reverseDot1qVlanId(29305/243)<unsigned16>[2]
          reverseDot1qPriority(29305/244)<unsigned8>[1]
          reverseDot1qCustomerVlanId(29305/245)<unsigned16>[2]
          reverseDot1qCustomerPriority(29305/246)<unsigned8>[1]
          reverseMetroEvcId(29305/247)<string>[100]
          reverseMetroEvcType(29305/248)<unsigned8>[1]
          reversePseudoWireId(29305/249)<unsigned32>[4]
          reversePseudoWireType(29305/250)<unsigned16>[2]
          reversePseudoWireControlWord(29305/251)<unsigned32>[4]
          reverseIngressPhysicalInterface(29305/252)<unsigned32>[4]
          reverseEgressPhysicalInterface(29305/253)<unsigned32>[4]
          reversePostDot1qVlanId(29305/254)<unsigned16>[2]
          reversePostDot1qCustomerVlanId(29305/255)<unsigned16>[2]
          reverseEthernetType(29305/256)<unsigned16>[2]
          reversePostIpPrecedence(29305/257)<unsigned8>[1]).each { |spec| add_spec(spec) }
      self
    end
    
  end # class InfoModel
end # module IPFIX